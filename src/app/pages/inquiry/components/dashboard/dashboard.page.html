<ion-grid *ngIf="isLoading">
  <ion-row>
    <ion-col size="12" size-sm="8" offset-sm="2" class="ion-text-center">
      <ion-spinner color="primary"></ion-spinner>
    </ion-col>
  </ion-row>
</ion-grid>
<div class="dashboard-wrap" *ngIf="!isLoading">
  <div class="attendance-absence">
    <h3>{{'Data.Attendance' |translate}} / {{'Data.Absence' | translate }}
    </h3>
    <ion-row *ngIf="!employeeAttendanceShow">
      <ion-col class="ion-text-center">
        <p>{{'Data.loading' | translate}}</p>
        <ion-spinner color="primary" name="lines"></ion-spinner>
      </ion-col>
    </ion-row>
    <apx-chart *ngIf="employeeAttendanceShow"
      [series]="attendance.series"
      [plotOptions]="attendance.plotOptions"
      [colors]="attendance.colors"
      [chart]="attendance.chart"
      [labels]="attendance.labels"
      [legend]="attendance.legend"
      [plotOptions]="attendance.plotOptions"
    ></apx-chart>
  </div>

  <hr />

  <div class="attendance-absence">
    <h3>{{'Data.Lates' |translate}}
    </h3>
    <ion-row *ngIf="!employeeLateShow">
      <ion-col class="ion-text-center">
        <p>{{'Data.loading' | translate}}</p>
        <ion-spinner color="primary" name="lines"></ion-spinner>
      </ion-col>
    </ion-row>
    <apx-chart *ngIf="employeeLateShow"
      [series]="lates.series"
      [plotOptions]="lates.plotOptions"
      [colors]="lates.colors"
      [chart]="lates.chart"
      [labels]="lates.labels"
      [legend]="lates.legend"
      [plotOptions]="lates.plotOptions"
    ></apx-chart>
  </div>
  <hr />
  <div class="attendance-absence">
    <h3 >{{ 'Data.PartDayPermission' | translate}}</h3>
    <ion-row *ngIf="!employeePermissionShow">
      <ion-col class="ion-text-center">
        <p>{{'Data.loading' | translate}}</p>
        <ion-spinner color="primary" name="lines"></ion-spinner>
      </ion-col>
    </ion-row>
    <div class="filter-wrap d-flex mt-15" *ngIf="employeePermissionShow">
      <div class="date">{{ permissionTypes | findNameInList:filter.partialPermissionTypeId}}</div>
      <div class="filter-icon">
        <div class="icons">
          <div (click)="showModal('permission')" class="icon filter-icon">
            <ion-icon name="funnel-sharp"></ion-icon>
          </div>
        </div>
      </div>
    </div>

    <apx-chart
    *ngIf="employeePermissionShow"
      [series]="permissions.series"
      [plotOptions]="permissions.plotOptions"
      [colors]="permissions.colors"
      [chart]="permissions.chart"
      [labels]="permissions.labels"
      [legend]="permissions.legend"
      [plotOptions]="permissions.plotOptions"
    ></apx-chart>
  </div>
  <hr />
  <div class="attendance-absence">
    <h3 >{{ 'Data.Leaves' | translate}}</h3>
    <ion-row *ngIf="!employeeLeaveShow">
      <ion-col class="ion-text-center">
        <p>{{'Data.loading' | translate}}</p>
        <ion-spinner color="primary" name="lines"></ion-spinner>
      </ion-col>
    </ion-row>
    <div class="filter-wrap d-flex mt-15" *ngIf="employeeLeaveShow">
      <div class="date">{{ leaveTypes | findNameInList:filter.leaveTypeId}}</div>
      <div class="filter-icon">
        <div class="icons">
          <div (click)="showModal('leave')" class="icon filter-icon">
            <ion-icon name="funnel-sharp"></ion-icon>
          </div>
        </div>
      </div>
    </div>

    <apx-chart
    *ngIf="employeeLeaveShow"
      [series]="leaves.series"
      [plotOptions]="leaves.plotOptions"
      [colors]="leaves.colors"
      [chart]="leaves.chart"
      [labels]="leaves.labels"
      [legend]="leaves.legend"
      [plotOptions]="leaves.plotOptions"
    ></apx-chart>
  </div>
  <hr />
  <div class="attendance-absence">
    <h3 >{{ 'Data.MyDuty' | translate}}</h3>
    <ion-grid *ngIf="duty.errorMessage && duty.dutyNameFl == null">
      <ion-row  >
        <ion-col size="12" size-sm="8" offset-sm="2" class="ion-text-center">
          <ion-text>
            <p>{{ duty.errorMessage }} </p>
          </ion-text>
        </ion-col>
      </ion-row>
    </ion-grid>
    <ion-grid fixed class="p-0" *ngIf="duty.dutyNameFl!=null ">
      <ion-row class="mb-4 mt-2">
        <ion-col size="6" class="p-0">
          <div>
            <ion-text class="txt">{{ 'Data.DutyType' | translate}}:
              {{ localize.isEnglish() ? duty.dutyTypeNameFl : duty.dutyTypeNameSl}}</ion-text>
          </div>
        </ion-col>
        <ion-col size="6" class="p-0">
          <div>
            <ion-text class="txt">{{'Data.DutyName' | translate}}:
              {{ localize.isEnglish() ? duty.dutyNameFl : duty.dutyNameSl}}</ion-text>
          </div>
        </ion-col>
      </ion-row>
      <ion-row class="mb-4">
        <ion-col size="6" class="p-0">
          <div>
            <ion-text class="txt">{{'Data.StartTime' | translate}}: {{ duty.dutyStartTime}}</ion-text>
          </div>
        </ion-col>
        <ion-col size="6" class="p-0">
          <div>
            <ion-text class="txt">{{'Data.EndTime' | translate}}: {{ duty.dutyEndTime }}</ion-text>
          </div>
        </ion-col>
      </ion-row>
      <ion-row>
        <ion-col size="6" class="p-0">
          <div>
            <ion-text class="txt">{{'Data.ActualIn' | translate}}: {{ duty.logInTime }}</ion-text>
          </div>
        </ion-col>
        <ion-col size="6" class="p-0">
          <div>
            <ion-text class="txt">{{'Data.ActualOut' | translate}}: {{ duty.logOutTime }}</ion-text>
          </div>
        </ion-col>
      </ion-row>
    </ion-grid>   
  </div>
  <hr />
  <div class="attendance-absence ion-text-center">
    <h3 >{{ 'Data.WorkingHours' | translate}}</h3>
    <div class="filter-wrap d-flex mt-15">
      <div class="date">
        <ion-button  color="danger" style="font-size: 11px;"  (click)="ChangeWeek('-')">
          <ion-icon  name="arrow-back" ></ion-icon>          
          {{'Data.previous' | translate}}
        </ion-button>
      </div>
      <div style="text-align: center; font-size: small;">
         {{dayDate | localizedDate}} - {{oldDate | localizedDate}}
      </div>
      <div class="filter-icon">
        <div class="icons">
          <ion-button [disabled]="isCurrentDate"  color="danger" style="font-size: 11px;" (click)="ChangeWeek('+')">
            {{'Data.next' | translate}}
            <ion-icon name="arrow-forward" ></ion-icon>
          </ion-button>
        </div>
      </div>
    </div>
    <apx-chart 
        style="direction: ltr !important;"
        [series]="workingHours.series"
        [plotOptions]="workingHours.plotOptions"
        [colors]="workingHours.colors"
        [chart]="workingHours.chart"
        [dataLabels]="workingHours.dataLabels"
        [legend]="workingHours.legend"
        [plotOptions]="workingHours.plotOptions"
        [yaxis]="workingHours.yaxis"
        >
    </apx-chart>
    <ion-text style="font-size: 13px;" >
      {{'Data.totalWorkingHours' |translate}}
      <span style="color: #00E396;  font-weight: bold;"> {{sumWorkingHour}} </span> 
        / 
      <span style="color: #775DD0;  font-weight: bold;"> {{ sumExpectedWorkingHour }} </span>
      {{'Data.totalExpectedWorkingHours' |translate}}       
    </ion-text>
  </div>
  <hr />
  <div class="attendance-absence">
    <h3 >{{ 'Data.MyHolidays' | translate}}</h3>
    <ion-list *ngFor="let holiday of holidayList">
      <ion-item>
        <ion-label class="ion-text-wrap">
          <ion-text color="favorite">
            <h3>
              {{ localize.isEnglish() ? holiday.publicHolidayNameFl :holiday.publicHolidayNameSl }}
            </h3>
          </ion-text>
          <p>
            {{ holiday.startDate | localizedDate }} - 
            {{ holiday.endDate | localizedDate }}
          </p>
        </ion-label>
      </ion-item>
    </ion-list>
    <ion-text *ngIf="holidayList.length == 0 "  >
      <p style="color: black; text-align: center;"> {{'message.noHolidays' |translate}}</p>
    </ion-text>
    <ion-button color="danger" (click)="goToHolidays('home/inquiry/holiday-list')" >
      {{'Data.More' |translate}}
    </ion-button> 
    <!-- <apx-chart
      [series]="holidayDates.series"
      [plotOptions]="holidayDates.plotOptions"
      [chart]="holidayDates.chart"
      [dataLabels]="holidayDates.dataLabels"
      [xaxis]="holidayDates.xaxis"
      [yaxis]="holidayDates.yaxis"
      [grid]="holidayDates.grid"
    ></apx-chart> -->
  </div>
</div>


<ng-template #filterContent>
  <div class="filter-content">
    <div class="form">
      <div class="form-input filter" *ngIf="showPermissonFilter">
        <ion-label position="stacked">{{'Data.PermissionType' | translate}}</ion-label>
        <ion-item>
          <ion-select  interface="popover" style="padding: initial;"
            placeholder="{{ 'Data.Type' | translate}}"  [(ngModel)]="filter.partialPermissionTypeId" (ionChange)="modal.toggleShow();getEmployeePermissionBalance();">
            <ion-select-option *ngFor="let type of permissionTypes" [value]="type.id">
              {{ localize.isEnglish() ? type?.nameFl : type?.nameSl }}
            </ion-select-option>
          </ion-select>
        </ion-item>
      </div>

      <div class="form-input filter" *ngIf="showLeaveFilter">
        <ion-label position="stacked">{{'Data.LeaveType' | translate}}</ion-label>
        <ion-item>
          <ion-select  interface="popover" style="padding: initial;"
          placeholder="{{ 'Data.Type' | translate}}"  [(ngModel)]="filter.leaveTypeId" (ionChange)="modal.toggleShow();getEmployeeLeaveBalance();">
          <ion-select-option *ngFor="let type of leaveTypes" [value]="type.id">
            {{ localize.isEnglish() ? type?.nameFl : type?.nameSl }}
          </ion-select-option>
        </ion-select>
        </ion-item>
      </div>
    </div>
  </div>
</ng-template>
